# 196
---
```
DELETE FROM Person
WHERE id NOT IN (
    SELECT id
    FROM (
        SELECT MIN(id) AS id
        FROM Person
        GROUP BY email
    ) AS temp
);
```
![image](https://github.com/KlagT/LeetCode/assets/90261661/f40fb7bb-d4bb-4463-9701-558b5c1e386c)
---
# 1934
---
```
SELECT 
    s.user_id,
    IFNULL(
        ROUND(
            SUM(CASE WHEN c.action = 'confirmed' THEN 1 ELSE 0 END) / COUNT(c.user_id),
            2
        ),
        0.00
    ) AS confirmation_rate
FROM 
    Signups s
LEFT JOIN 
    Confirmations c ON s.user_id = c.user_id
GROUP BY 
    s.user_id;
```
![image](https://github.com/KlagT/LeetCode/assets/90261661/e73784b3-28bb-4753-8023-15fdac6131fc)
---
# 570
---
```
SELECT name
FROM Employee
WHERE id IN (
    SELECT managerId
    FROM Employee
    WHERE managerId IS NOT NULL
    GROUP BY managerId
    HAVING COUNT(*) >= 5
);
```
---
![image](https://github.com/KlagT/LeetCode/assets/90261661/d7a41e65-0130-468a-9260-78c2c9b03a8c)
# 184
---
```
SELECT 
    d.name AS Department,
    e.name AS Employee,
    e.salary AS Salary
FROM 
    Employee e
JOIN 
    Department d ON e.departmentId = d.id
JOIN 
    (SELECT 
         departmentId,
         MAX(salary) AS max_salary
     FROM 
         Employee
     GROUP BY 
         departmentId) max_salaries
ON 
    e.departmentId = max_salaries.departmentId
AND 
    e.salary = max_salaries.max_salary;
```
![image](https://github.com/KlagT/LeetCode/assets/90261661/0333a7b8-b2ea-4320-95a3-050ee5cd66d2)
---
# 183
---
```
SELECT c.name AS Customers
FROM Customers c
LEFT JOIN Orders o ON c.id = o.customerId
WHERE o.customerId IS NULL;
```
![image](https://github.com/KlagT/LeetCode/assets/90261661/447cced0-e01c-48a7-b7a2-4df517d395de)
---
# 182
---
```
SELECT email as Email FROM Person  
GROUP BY email HAVING COUNT(*) > 1;
```
![image](https://github.com/KlagT/LeetCode/assets/90261661/00059c10-5507-4bbf-8eba-af389fb17c03)
---
# 181
---
```
SELECT e1.name AS Employee FROM Employee e1 
JOIN Employee e2 ON e1.managerId = e2.Id AND e1.salary > e2.salary;
```
![image](https://github.com/KlagT/LeetCode/assets/90261661/81af76ea-3b2b-40f5-8a65-426e31c47ef2)
---
# 178
---
```
SELECT s.Score , COUNT(t.Score) AS 'Rank' FROM 
(SELECT DISTINCT Score FROM Scores) AS t , Scores AS s 
WHERE s.Score <= t.Score 
GROUP BY s.id, s.Score 
ORDER BY s.Score DESC;
```
![image](https://github.com/KlagT/LeetCode/assets/90261661/ba0f7d6f-55de-4eaf-87f9-120bab29fb10)
---
# 176
---
```
SELECT 
    (SELECT DISTINCT salary
     FROM Employee
     ORDER BY salary DESC
     LIMIT 1 OFFSET 1) AS SecondHighestSalary;
```
![image](https://github.com/KlagT/LeetCode/assets/90261661/0ae7cc50-df40-477b-9def-cb222dbcaebe)

![image](https://github.com/KlagT/LeetCode/assets/90261661/72f4d8d7-ee1c-4bc9-bc15-8053c272907c)

---
# 175
---
```
SELECT p.firstName,
       p.lastName,
       a.city,
       a.state
FROM Person p
LEFT JOIN Address a ON p.personId = a.personId;
```
![image](https://github.com/KlagT/LeetCode/assets/90261661/6ce434c3-88dd-4bf8-a662-6cfb468d5b3d)

---
# 206
---
```
# Definition for singly-linked list.
class ListNode:
    def __init__(self, val=0, next=None):
        self.val = val
        self.next = next

class Solution:
    def reverseList(self, head: ListNode) -> ListNode:
        prev = None
        curr = head
        
        while curr:
            next_node = curr.next  # Store the next node
            curr.next = prev       # Reverse the current node's pointer
            prev = curr            # Move prev to the current node
            curr = next_node       # Move to the next node in the list
        
        return prev  # prev will be the new head of the reversed list


```
![image](https://github.com/KlagT/LeetCode/assets/90261661/5ff62432-70fb-4554-ba97-1faa733888d1)

![image](https://github.com/KlagT/LeetCode/assets/90261661/e302b5c7-b19d-4bdd-bb83-f6b2a92de4d7)

![image](https://github.com/KlagT/LeetCode/assets/90261661/909d5089-827c-4f98-b004-8b67dc4ba684)


